library(ApicalOrgan2021)
foster.path <- "G:/My Drive/Postgrad/PhD/Projects/data/Foster_2020/"
loadFoster2020 <- function(foster.path) {
# Load SingleCellExperiment
echino.sce <- readRDS(paste0(foster.path,"sce.rds"))
# Reannotate stage
echino.sce$stage <- ""
echino.sce$stage[echino.sce$orig.ident=="Sp1"] <- "8-cell"
echino.sce$stage[echino.sce$orig.ident=="Sp2"] <- "64-cell"
echino.sce$stage[echino.sce$orig.ident=="Sp3"] <- "Morula"
echino.sce$stage[echino.sce$orig.ident=="EB"] <- "Early blastula"
echino.sce$stage[echino.sce$orig.ident=="HB"] <- "Hatched blastula"
echino.sce$stage[echino.sce$orig.ident=="MB"] <- "Mesenchyme blastula"
echino.sce$stage[echino.sce$orig.ident=="EG"] <- "Early gastrula"
echino.sce$stage[echino.sce$orig.ident=="LG"] <- "Late gastrula"
echino.sce$stage <- factor(echino.sce$stage,
levels=c("8-cell","64-cell","Morula","Early blastula",
"Hatched blastula","Mesenchyme blastula",
"Early gastrula","Late gastrula"))
# Label cell types from Seurat clusters
echino.sce$original_annotation <- "Other"
echino.sce$original_annotation[echino.sce$seurat_clusters %in% c(3,9,17,18)] <- "Neural"
echino.sce$original_annotation[echino.sce$seurat_clusters %in% c(20)] <- "Germline"
echino.sce$original_annotation[echino.sce$seurat_clusters %in% c(1,4,12,13)] <- "Oral ectoderm"
echino.sce$original_annotation[echino.sce$seurat_clusters %in% c(16,19)] <- "Skeleton"
echino.sce$original_annotation[echino.sce$seurat_clusters %in% c(6,8,14)] <- "Endoderm"
echino.sce$original_annotation[echino.sce$seurat_clusters %in% c(2,7)] <- "Ciliated cells"
echino.sce$original_annotation[echino.sce$seurat_clusters %in% c(11)] <- "Pigment cells"
echino.sce$original_annotation[echino.sce$seurat_clusters %in% c(0,5)] <- "Aboral ectoderm"
# Add refined AO annotations
AO_annotations <- read.csv(paste0(foster.path,"Gattoni2021_annotation.tsv"),
sep="\t",header = F)
echino.sce$AO_annotation <- AO_annotations[,1]
# Edit annotations for heatmap plots
echino.sce$AO_heatmap_annotation <- echino.sce$AO_annotation
echino.sce$AO_heatmap_annotation[echino.sce$AO_heatmap_annotation=="Serotonergic neurons"] <- "SN"
echino.sce$AO_heatmap_annotation[
echino.sce$AO_heatmap_annotation%in%c("Oral ectoderm", "Aboral ectoderm",
"Ciliated cells")
] <- "Other ectoderm"
echino.sce$AO_heatmap_annotation[
echino.sce$AO_heatmap_annotation%in%c("Skeleton", "Pigment cells")
] <- "Mesoderm"
echino.sce$AO_heatmap_annotation[
echino.sce$AO_heatmap_annotation%in%c("Germline", "Other")
] <- "Other"
# Enforce specific cell type ordering
echino.sce$AO_heatmap_annotation <- factor(echino.sce$AO_heatmap_annotation,
levels=c("Early AP","Late AP",
"SN","Other neural",
"Other ectoderm",
"Mesoderm","Endoderm",
"Other"))
echino.sce$AO_heatmap_stage <- echino.sce$stage
levels(echino.sce$AO_heatmap_stage) <- c("8c","64c","M","EB","HB","MB","EG",
"LG")
return(echino.sce)
}
source("load.R")
foster.path <- "G:/My Drive/Postgrad/PhD/Projects/data/Foster_2020/"
echino.sce <- loadFoster2020(foster.path)
echino.sce <- loadFoster2020(foster.path)
echino.sce
colData(echino.sce)[1:5,]
meta <- colData(echino.sce)
write.csv(meta,"G:/My Drive/Postgrad/PhD/Projects/ApicalOrgan2021/data-in/meta.tsv",sep="\t",quote=F)
write.table(meta,"G:/My Drive/Postgrad/PhD/Projects/ApicalOrgan2021/data-in/meta.tsv",sep="\t",quote=F)
meta
meta <- meta[,1:11]
write.table(meta,"G:/My Drive/Postgrad/PhD/Projects/ApicalOrgan2021/data-in/meta.tsv",sep="\t",quote=F)
meta <- colData(echino.sce)
meta
meta <- meta[,1:12]
write.table(meta,"G:/My Drive/Postgrad/PhD/Projects/ApicalOrgan2021/data-in/meta.tsv",sep="\t",quote=F)
library(ApicalOrgan2021)
library(ApicalOrgan2021)
source("../utils/load.R")
echino.sce <- loadFoster2020(foster.path)
library(umap)
?umap
?runUMAP
?runTSNE
echino.sce
library(ApicalOrgan2021)
source("../utils/load.R")
library(gridExtra)
set.seed(42)
echino.sce <- computeUMAP(echino.sce,min_dist=0.8,n_neighbours=100)
use_condaenv("AO_env",conda = "C:/anaconda/condabin/conda",required = T)
library(reticulate)
use_condaenv("AO_env",conda = "C:/anaconda/condabin/conda",required = T)
library(reticulate)
use_condaenv("AO_env",conda = "C:/anaconda/condabin/conda",required = T)
echino.sce
echino.sce <- computeUMAP(echino.sce,min_dist=0.8,n_neighbours=100)
library(ApicalOrgan2021)
echino.sce <- computeUMAP(echino.sce,min_dist=0.8,n_neighbours=100)
library(ApicalOrgan2021)
use_condaenv("AO_env",conda = "C:/anaconda/condabin/conda",required = T)
echino.sce <- computeUMAP(echino.sce,min_dist=0.8,n_neighbours=100)
library(reticulate)
use_condaenv("AO_env",conda = "C:/anaconda/condabin/conda",required = T)
library(ApicalOrgan2021)
echino.sce <- computeUMAP(echino.sce,min_dist=0.8,n_neighbours=100)
library(umap)
echino.sce <- computeUMAP(echino.sce,min_dist=0.8,n_neighbours=100)
py_install("umap-learn")
echino.sce <- computeUMAP(echino.sce,min_dist=0.8,n_neighbours=100)
?computeUMAP
library(ApicalOrgan2021)
?computeUMAP
devtools::document()
?computeUMAP
library(reticulate)
use_condaenv("AO_env",conda = "C:/anaconda/condabin/conda",required = T)
py_config()
echino.sce <- computeUMAP(echino.sce,min_dist=0.8,n_neighbours=100)
echino.sce <- computeUMAP(echino.sce,min_dist=0.8,n_neighbours=100)
library(reticulate)
use_condaenv("AO_env",conda = "C:/anaconda/condabin/conda",required = T)
library(ApicalOrgan2021)
echino.sce <- computeUMAP(echino.sce,min_dist=0.8,n_neighbours=100)
library(ApicalOrgan2021)
echino.sce <- computeUMAP(echino.sce,min_dist=0.8,n_neighbours=100)
